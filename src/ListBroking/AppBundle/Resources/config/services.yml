imports:
    - { resource: admin_services.yml }

services:
  listbroking.appbundle.filters.form:
    class:  ListBroking\AppBundle\Form\FiltersForm
    arguments: [@app, @lead]
    tags:
      - { name: form.type, alias: filters }

  listbroking.appbundle.json.form.type:
    class: ListBroking\AppBundle\Form\Type\JsonType
    tags:
      - { name: form.type, alias: json }

  base:
    class: ListBroking\AppBundle\Service\BaseService\BaseService
    abstract: true
    calls:
      - [setLogger, [@logger]]
      - [setDoctrine, [@doctrine]]
      - [setEntityManager, [@doctrine.orm.entity_manager]]
      - [setCache, [@doctrine_cache.providers.memcached_query_cache]]
      - [setFormFactory, [@form.factory]]

  app:
    class: ListBroking\AppBundle\Service\AppService
    parent: base

  lead:
    class: ListBroking\AppBundle\Service\LeadService
    arguments:
      entityManager: @doctrine.orm.entity_manager

  extraction:
    class: ListBroking\AppBundle\Service\ExtractionService
    parent: base
    arguments: [@request_stack,  @session, @filter_engine]


  filter_engine:
    class: ListBroking\AppBundle\Engine\FilterEngine
    arguments:
      entityManager: @doctrine.orm.entity_manager

#  ui:
#    class: ListBroking\AppBundle\Service\UIService
#    arguments:
#      - @app
#      - @extraction
#      - @lead
#      - @form.factory
#      - @security.csrf.token_manager
#      - @doctrine.orm.entity_manager
